<div class="input-group">
    <label>Service Fee (%)</label>
    <input type="number" step="0.1" id="service_fee_percent" value="4.5">
</div>

<button onclick="calculate()">Calculate Total Price</button>

<div class="result">
    <div class="calculation-steps">
        <h3>Detailed Calculation Breakdown</h3>
        <div id="detailed_calculation"></div>
    </div>

    <hr>

    <div class="total-summary">
        <p class="tax-calculation">Tax per Ticket: 
            <span id="tax_per_unit">$0</span>
        </p>
        <p class="profit-margin">Profit Margin after Markup: 
            <span id="profit_margin">$0</span> 
            (<span id="profit_margin_percent">0%</span>)
        </p>
        <p>Total Before Fees: <span id="total_before_fee">$0</span></p>
        <p>Service Fee: <span id="service_fee">$0</span></p>
        <p class="price-per-ticket">Final Total Price: 
            <span id="final_price">$0</span>
            <span class="currency-rate" id="final_price_eur">€0</span>
            <span class="currency-rate" id="final_price_gbp">£0</span>
        </p>
        <p>Price per Ticket: <span id="price_per_ticket">$0</span></p>
    </div>
</div>

<script>
function calculate() {
    const wholesale = parseFloat(document.getElementById('wholesale').value);
    const quantity = parseInt(document.getElementById('quantity').value) || 1;
    const taxPercent = parseFloat(document.getElementById('tax_percent').value) || 0;
    const markupType = document.getElementById('markup_type').value;
    const markupValue = parseFloat(document.getElementById('markup_value').value) || 0;
    const serviceFeePercent = parseFloat(document.getElementById('service_fee_percent').value) || 4.5;

    const totalWholesale = wholesale * quantity;
    const taxAmount = totalWholesale * (taxPercent / 100);
    let markupAmount = markupType === 'fixed' ? markupValue : totalWholesale * (markupValue / 100);
    const totalBeforeFee = totalWholesale + taxAmount + markupAmount;
    const serviceFee = totalBeforeFee * (serviceFeePercent / 100);
    const finalTotal = totalBeforeFee + serviceFee;

    document.getElementById('tax_per_unit').textContent = `$${taxAmount.toFixed(2)}`;
    document.getElementById('profit_margin').textContent = `$${markupAmount.toFixed(2)}`;
    document.getElementById('profit_margin_percent').textContent = `${((markupAmount / totalWholesale) * 100).toFixed(2)}%`;
    document.getElementById('total_before_fee').textContent = `$${totalBeforeFee.toFixed(2)}`;
    document.getElementById('service_fee').textContent = `$${serviceFee.toFixed(2)}`;
    document.getElementById('final_price').textContent = `$${finalTotal.toFixed(2)}`;
    document.getElementById('price_per_ticket').textContent = `$${(finalTotal / quantity).toFixed(2)}`;
}
</script>
